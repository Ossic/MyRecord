# 千年虫问题

## 什么是千年虫

>   2000年问题（Year 2000 Problem，简称Y2K），大陆及香港常称为千年虫问题，台湾则称千禧虫危机，是指由于计算机程序设计的一些问题，使得计算机在处理2000年1月1日以后的日期和时间时候，可能会出现不正确的操作，从而可能导致一些敏感的工业部门（比如电力，能源）和银行，政府等部门在2000年1月1日零点工作停顿甚至是发生灾难性的结果。

## 原理是什么

两千年问题始于1960年代，**当时计算机内存和外部存储介质的成本很高**，大多数数据处理需要借助于用穿孔卡片，它用80行文本表示所储存的数据。为了节省硬件成本，葛丽丝·霍普在Harvard Mark I上，以6位数字来存储时间，即年、月、日各两位。这个习惯被COBOL继承下来，传播到整个计算机程序界。

虽然后来存储器的价格降低了，但这个习惯还是被传承了下来，很多程序员用2位表示年份

如1998年被表示为“98”、1999年被表示为“99”；而2000年被表示为“00”，这样将会导致某些程序在计算时得到不正确的结果，如**把“00”误解为1900年**。在嵌入式系统中可能存在同样的问题，这有可能导致设备停止运转或者发生更加灾难性的后果。

## 有多大的危害？

举个栗子：

-   假如当年有中国移动的话，你在1999年12月31日23：59分用运营商是中国移动的电话打了三分钟的电话，而当时的计费系统恰好存在这个大 Bug，第二天你就会接到 10086 MM 给你打电话哦，叫你去看看账单，你就会发现：次奥，话费多的连房子卖了都赔不起。！！！！因为电话局的账单可能显示为(100年－3分钟)；
-   当时，美国夏威夷电力公司甚至做了一项实际的实验，输入00年，结果电厂自动停止操作，在某些情况下也发生电压与频率方面的变化，造成用户全面停电、电器故障甚至烧毁；联邦核管处更是担心全美的百余座核电厂里的仪器由于2000年问题失控造成核辐射外泄等灾难。

## 如何解决

对于程序来说，就是在编写程序时抛弃当时从60年沿袭下来的传统--用两位数表示日期中的年，转而用四位数表示，日期扩大到包括世纪。

这被认为是“纯粹”的解决方案，明确了程序日期的编写格式，几乎是永久性地“解决了战斗”（除非你能活到xxxxx年）同时也易于维护。

对于数据库的话，也采用了类似的解决办法。然而，这种方法是昂贵的，**当年需要改大量的程序同时进行大量的测试和转换工作，通常影响到整个系统。有点像“重新编写世界的节奏”，花费的确不菲。**

>   此外仍然有一个问题：是否存在10000年问题。当然，在公元10000年时候互联网、人类文明、甚至世界都有可能不再存在。

据说当时哪一天很多的工厂、企业都停业了，还有人趁机坑蒙拐骗的.....

## 问题的延续

千年虫我们是没经历过，但是这不代表以后就没问题了，比如

>   2008年是闰年，所以这一年有2月29日。不过，有相当数量的摩托罗拉旧款手提电话在这一天由于系统无法表示这一日，系统将电话的日期强制重置为2001年1月1日。

因为闰年的原因，像2.28[离全年结束还有306天（闰年则还有307天）]、2.29(闰年中的第60天)、4.9(闰年是第100天，否则是第99天)这样的日子真的挺不好算的

忽然想起万年历到底是怎么算的呢，好像要用天体的运动来解释了，厉害

## 2038年问题

>   在计算机应用上，2038年问题可能会导致某些软件在2038年1月19日3时14分07秒之后无法正常工作。所有使用POSIX时间表示时间的程序都将受其影响，因为它们以自1970年1月1日经过的秒数（忽略闰秒）来表示时间。
>
>   这种时间表示法在类Unix（Unix-like）操作系统上是一个标准，并会影响以其C编程语言开发给其他大部分操作系统使用的软件。
>
>   在大部分的32位操作系统上，此“time_t”数据模式使用一个有正负号的**32位整数**（signed int32）存储计算的秒数。依照此“time_t”标准，在此格式能被表示的最后时间是2038年1月19日03:14:07，星期二（UTC）。超过此一瞬间，时间将会“绕回”（wrap around）且在内部被表示为一个负数，并造成程序无法工作，因为它们无法将此时间识别为2038年，而可能会依个别实现而跳回1970年或1901年。错误的计算及动作可能因此产生。

## 解决

大部分64位操作系统已经把time_t这个系统变量改为64位宽。不过，其他现有架构的改动仍在进行中，不过预期“应该可以在2038年前完成”。

然而，直到2006年，仍然有数以亿计的32位系统在运行中，特别是许多嵌入式系统。相对于一般电脑科技18至24个月的革命性更新，嵌入式系统可能直至使用寿命终结都不会改变。

32位time_t的使用亦被编码于文件格式，例如众所周知的ZIP压缩格式。其能存在的时间远比受影响的机器长。

**新的64位运算器可以记录至约2900亿年后的292,277,026,596年12月4日15:30:08，星期日（UTC）。**