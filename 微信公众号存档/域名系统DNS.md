# 域名系统DNS

## 什么是DNS

> **网域名称系统**（英文：**D**omain **N**ame **S**ystem，缩写：**DNS**）是互联网的一项服务。它作为将域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。DNS使用TCP和UDP端口53。当前，对于每一级域名长度的限制是63个字符，域名总长度则不能超过253个字符。

简单说：我们访问一个网站必须通过IP才能找到，但是IP太难记了，所以有了域名(一般是拼音或英语单词)，比较好记，DNS就起中转作用，过程就像查一本书的目录一样，书中记录域名和对应的IP

## 域名空间结构

要了解DNS的工作原理，先了解下域名的结构比较好
整个Internet的DNS域名系统的结构如同一棵倒过来的树，层次结构非常清楚。根域位于最顶端。



- 根域：
  以`.`表示，根是由13台DNS服务器(全球一共就这些，中国木有)组成，由不同机构管理，所有的DNS服务器都知道它的IP地址，它主要管理顶级域名
  也就是说，它知道所有顶级域名的地址，但其他的就不好说了
- 顶级域：
  由数台DNS服务器组成，由ISO分配决定，数量是极其有限的，部分国家、地区的域名是允许个人注册的(比如.me，对这是个国家域名)
  它一定知道它下面各种二级域名的DNS的IP地址
- 二级域：
  供组织机构申请使用，如`abc.com`，此域名须先申请成功后才可以用(一般是收费的)。
- 子域：
  在二级域名下可以设多级子域。如`www.loli.net`、`ftp.loli.net`就是`loli.net`的子域
- 主机：
  按照FQDN要求，这三个主机的完整名称是`www.loli.net`/`ftp.loli.net`/`mail.loli.net`。而**www**、**ftp**与**mail**则代表为`loli.net`的主机。

## 域名解析

关于DNS的查询过程

首先会向`本地域名服务器`发起请求，如果没有会向你电脑所配置的DNS服务器查询(这里说下，曾经查询过的域名都会在本地有缓存，下次再访问会直接从本地域名服务器获得，以及自己配置的host文件中的指向，host的优先级高于配置的DNS服务器)

前面说过，所有的DNS服务器都知道根域的地址，如果找不到就会去请求根域，根域会返回相应的顶级域名的DNS的IP，于是计算机再向对应的顶级DNS服务器发起请求，一层一层最终得到真正的IP地址

从查询方式上分为两种：**递归**和**迭代**。
DNS客户端设置使用的DNS服务器一般都是递归服务器，它负责全权处理客户端的DNS查询请求，**直到返回最终结果，否则会返回错误**。
DNS服务器之间一般采用迭代查询方式，这可以说是一种模糊查询，比如如果根域没有找到就会返回顶级域名的IP 。